<?xml version="1.0" encoding="windows-1250"?>
<project name="CO-OP Funeralcare - Create PROD Packages v1.2">
  <workingDirectory>c:\SVN_Working_Directory\COOP_FNC\COOP_PROD</workingDirectory>
  <artifactDirectory>c:\CCNet_Artefacts_Directory\COOP_FNC\COOP_PROD</artifactDirectory>
  <webURL>http://vmp-ccnet/server/local/project/CO-OP%20Funeralcare%20-%20Create%20PROD%20Packages/ViewProjectReport.aspx</webURL>
    <category>Package</category>

    <labeller type="assemblyVersionLabeller">
        <major>1</major>
        <minor>2</minor>
        <build>0</build>
        <incrementOnFailure>false</incrementOnFailure>
    </labeller>

    <publishers>
        <xmllogger logDir="buildlogs" />
        <artifactcleanup cleanUpMethod="KeepLastXBuilds" cleanUpValue="50" />
        <rss items="50" />
    </publishers>

  <sourcecontrol type="svn">
    <trunkUrl>svn://vm-svn.fcdev.local/funeralcare/branches/v1.2</trunkUrl>
    <username>dev.tools</username>
    <password>KL129377</password>
    <workingDirectory>c:\SVN_Working_Directory\COOP_FNC\COOP_PROD</workingDirectory>
    <executable>C:\Program Files\CollabNet\Subversion Client\svn.exe</executable>
	<tagOnSuccess>true</tagOnSuccess>
	<tagBaseUrl>svn://vm-svn.fcdev.local/funeralcare/tags</tagBaseUrl>
	<tagWorkingCopy>true</tagWorkingCopy>
    <cleanUp>true</cleanUp>
  </sourcecontrol>
  <tasks>
	  <!-- build web application -->
	  <msbuild>
		<executable>C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe</executable>
		<workingDirectory>c:\SVN_Working_Directory\COOP_FNC\COOP_PROD</workingDirectory>
		<projectFile>SolutionFiles\Funeralcare.Web.sln</projectFile>
		<buildArgs>/noconsolelogger /v:diag /p:ReferencePath="C:\SVN_Working_Directory\COOP_FNC\COOP_PROD\Lib\Funeralcare.Web.Lib" /p:Configuration=PROD_DC1_ADM</buildArgs>
		<targets>Build</targets>
		<timeout>900</timeout>
		<logger>C:\Program Files (x86)\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MSBuild.dll</logger>
	  </msbuild>
	  
 	<!-- deployment package  -->
		<exec>
			<executable>cmd.exe</executable>
			<buildArgs>/c "if exist c:\SVN_Working_Directory\COOP_FNC\COOP_PROD\Package\PROD_DC1_ADM del c:\SVN_Working_Directory\COOP_FNC\COOP_PROD\Package\PROD_DC1_ADM\*.* /Q /F"</buildArgs>
		</exec>
		<msbuild>
			<executable>C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe</executable>
			<projectFile>Funeralcare.Web.Mvc\Funeralcare.Web.csproj</projectFile>
			<dynamicValues>
				<replacementValue property="buildArgs">
				<format>/noconsolelogger /v:diag /t:Package /p:PackageLocation="C:\BuildPackages\COOP_FNC\PROD\COOP_FNC-PROD_DC1_ADM-{0}\COOP_FNC-PROD_DC1_ADM-{0}.zip" /p:Configuration=PROD_DC1_ADM</format>
					<parameters>
						<namedValue name="$CCNetLabel" value="Default" />
					</parameters>
				</replacementValue>
			</dynamicValues>
			<targets>Package</targets>
			<timeout>900</timeout>
			<logger>C:\Program Files (x86)\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MSBuild.dll</logger>
		</msbuild> 	
		<exec>
			<executable>cmd.exe</executable>
			<buildArgs>/c "if exist c:\SVN_Working_Directory\COOP_FNC\COOP_PROD\Package\PROD_DC1_WEB del c:\SVN_Working_Directory\COOP_FNC\COOP_PROD\Package\PROD_DC1_WEB\*.* /Q /F"</buildArgs>
		</exec>
		<msbuild>
			<executable>C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe</executable>
			<projectFile>Funeralcare.Web.Mvc\Funeralcare.Web.csproj</projectFile>
			<dynamicValues>
				<replacementValue property="buildArgs">
				<format>/noconsolelogger /v:diag /t:Package /p:PackageLocation="C:\BuildPackages\COOP_FNC\PROD\COOP_FNC-PROD_DC1_WEB-{0}\COOP_FNC-PROD_DC1_WEB-{0}.zip" /p:Configuration=PROD_DC1_WEB</format>
					<parameters>
						<namedValue name="$CCNetLabel" value="Default" />
					</parameters>
				</replacementValue>
			</dynamicValues>
			<targets>Package</targets>
			<timeout>900</timeout>
			<logger>C:\Program Files (x86)\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MSBuild.dll</logger>
		</msbuild>
		<exec>
			<executable>cmd.exe</executable>
			<buildArgs>/c "if exist c:\SVN_Working_Directory\COOP_FNC\COOP_PROD\Package\PROD_DC2_ADM del c:\SVN_Working_Directory\COOP_FNC\COOP_PROD\Package\PROD_DC2_ADM\*.* /Q /F"</buildArgs>
		</exec>
		<msbuild>
			<executable>C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe</executable>
			<projectFile>Funeralcare.Web.Mvc\Funeralcare.Web.csproj</projectFile>
			<dynamicValues>
				<replacementValue property="buildArgs">
				<format>/noconsolelogger /v:diag /t:Package /p:PackageLocation="C:\BuildPackages\COOP_FNC\PROD\COOP_FNC-PROD_DC2_ADM-{0}\COOP_FNC-PROD_DC2_ADM-{0}.zip" /p:Configuration=PROD_DC2_ADM</format>
					<parameters>
						<namedValue name="$CCNetLabel" value="Default" />
					</parameters>
				</replacementValue>
			</dynamicValues>
			<targets>Package</targets>
			<timeout>900</timeout>
			<logger>C:\Program Files (x86)\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MSBuild.dll</logger>
		</msbuild>
		<exec>
			<executable>cmd.exe</executable>
			<buildArgs>/c "if exist c:\SVN_Working_Directory\COOP_FNC\COOP_PROD\Package\PROD_DC2_WEB del c:\SVN_Working_Directory\COOP_FNC\COOP_PROD\Package\PROD_DC2_WEB\*.* /Q /F"</buildArgs>
		</exec>
		<msbuild>
			<executable>C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe</executable>
			<projectFile>Funeralcare.Web.Mvc\Funeralcare.Web.csproj</projectFile>
			<dynamicValues>
				<replacementValue property="buildArgs">
				<format>/noconsolelogger /v:diag /t:Package /p:PackageLocation="C:\BuildPackages\COOP_FNC\PROD\COOP_FNC-PROD_DC2_WEB-{0}\COOP_FNC-PROD_DC2_WEB-{0}.zip" /p:Configuration=PROD_DC2_WEB</format>
					<parameters>
						<namedValue name="$CCNetLabel" value="Default" />
					</parameters>
				</replacementValue>
			</dynamicValues>
			<targets>Package</targets>
			<timeout>900</timeout>
			<logger>C:\Program Files (x86)\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MSBuild.dll</logger>
		</msbuild>
    </tasks>
</project>
