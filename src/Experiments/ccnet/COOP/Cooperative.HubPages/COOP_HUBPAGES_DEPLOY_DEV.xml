<?xml version="1.0" encoding="windows-1250"?>
<project name="CO-OP Hub Pages - Deploy Dev">
 <workingDirectory>C:\GIT_Working_Directory\COOP\HUBPAGES\COOP_HUBPAGES_DEPLOY_DEV</workingDirectory>
  <artifactDirectory>c:\CCNet_Artefacts_Directory\COOP\HUBPAGES\COOP_HUBPAGES_DEPLOY_DEV</artifactDirectory>
  <webURL>http://vmp-ccnet/server/local/project/CO-OP%20HUBPAGES%20DEPLOY%20DEV/ViewProjectReport.aspx</webURL>
  <category>Internal Deployment</category>

    <labeller type="assemblyVersionLabeller">
        <major>1</major>
        <minor>0</minor>
        <build>0</build>
        <incrementOnFailure>false</incrementOnFailure>
    </labeller>

    <publishers>
        <xmllogger logDir="buildlogs" />
        <artifactcleanup cleanUpMethod="KeepLastXBuilds" cleanUpValue="50" />
        <rss items="50" />
    </publishers>

	<sourcecontrol type="git">
		<executable>C:\Program Files (x86)\Git\bin\git.exe</executable>
		<repository>git@bitbucket.org:fortunecookie/cooperative.hubpages.git</repository>
		<branch>development</branch>
		<workingDirectory>C:\GIT_Working_Directory\COOP\HUBPAGES\COOP_HUBPAGES_DEPLOY_DEV</workingDirectory>
		<timeout units="seconds">7000</timeout>
	</sourcecontrol>
  
  <tasks>  
  
	  <!-- build web application -->
	  <msbuild>
		<executable>C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe</executable>
		<workingDirectory>C:\GIT_Working_Directory\COOP\HUBPAGES\COOP_HUBPAGES_DEPLOY_DEV</workingDirectory>
		<projectFile>Solution Files\Cooperative.HubPages.sln</projectFile>
		<buildArgs>/noconsolelogger /v:diag /p:Configuration=PossibleDev</buildArgs>
		<targets>Build</targets>
		<timeout>900</timeout>
		<logger>C:\Program Files (x86)\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MSBuild.dll</logger>
	  </msbuild>
	  	  
	 <!-- deployment package  -->
		<exec>
			<executable>cmd.exe</executable>
			<buildArgs>/c "if exist C:\GIT_Working_Directory\COOP\HUBPAGES\COOP_HUBPAGES_DEPLOY_DEV\Package del C:\GIT_Working_Directory\COOP\PUBLIC\COOP_HUBPAGES_DEPLOY_DEV\Package\*.* /Q /F"</buildArgs>
		</exec>
		<msbuild>
			<executable>C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe</executable>
			<projectFile>Cooperative.HubPages.Web\Cooperative.HubPages.Web.csproj</projectFile>
			<buildArgs>/noconsolelogger /v:diag /t:Package /p:PackageLocation="C:\GIT_Working_Directory\COOP\HUBPAGES\COOP_HUBPAGES_DEPLOY_DEV\Package\Cooperative.HubPages.Web.zip" /p:Configuration=PossibleDev</buildArgs>
			<targets>Package</targets>
			<timeout>900</timeout>
			<logger>C:\Program Files (x86)\CruiseControl.NET\server\ThoughtWorks.CruiseControl.MSBuild.dll</logger>
		</msbuild> 
	  
	  <!--  Deploy to DEV  -->
		<exec>
			<executable>C:\GIT_Working_Directory\COOP\HUBPAGES\COOP_HUBPAGES_DEPLOY_DEV\Package\Cooperative.HubPages.Web.deploy.cmd</executable>
			<buildArgs>/y /m:vmp-dev-fnc -enableRule:AppOffline</buildArgs>
			<buildTimeoutSeconds>6000</buildTimeoutSeconds>
		</exec>
    </tasks>
</project>
